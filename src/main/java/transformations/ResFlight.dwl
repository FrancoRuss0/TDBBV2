%dw 2.0
output application/java
var cast = readUrl("classpath://CastingFunctions.dwl", "application/dw")
---
(data) -> data map (record,index) -> 
{
	ID : cast.toString(record[0]),
	PNRLocatorID : cast.toString(record[1]),
	PNRCreateDate : cast.toDate(record[2],"yyyy-MM-dd"),
	FromDateTime : cast.toLocalDateTime(record[3],"yyyy-MM-dd HH:mm:ss.SSSSSS"),
	SegmentNbr : cast.toNumber(record[4]),
	ActiveSegmentInd : cast.toString(record[5]),
	CdshrLegInd : cast.toString(record[6]),
	ClassOfService : cast.toString(record[7]),
	ConnectivityCode : cast.toString(record[8]),
	NbrInParty : cast.toNumber(record[9]),
	CurrentSegmentStatusCode : cast.toString(record[10]),
	PreviousSegmentStatusCode : cast.toString(record[11]),
	SegmentTypeCode : cast.toNumber(record[12]),
	ChangeSegmentStatusIndicator : cast.toString(record[13]),
	EquipmentCode : cast.toNumber(record[14]),
	MarketingFlightNbr : cast.toString(record[15]),
	FlightNbr : cast.toString(record[16]),
	MarketingAirlineCode : cast.toString(record[17]),
	OperatingFlightNbr : cast.toString(record[18]),
	OperatingAirlineCode : cast.toString(record[19]),
	AirlineCode : cast.toString(record[20]),
	InboundFlightConnectionInd : cast.toString(record[21]),
	MarriedConxInboundFlightInd : cast.toString(record[22]),
	OutboundFlightConnectionInd : cast.toString(record[23]),
	MarriedConxOutboundFlightInd : cast.toString(record[24]),
	ServiceStartCity : cast.toString(record[25]),
	ServiceStartDate : cast.toDate(record[26],"yyyy-MM-dd"),
	ServiceStartTime : cast.toLocalTime(record[27],"HH:mm:ss"),
	ServiceEndCity : cast.toString(record[28]),
	ServiceEndDate : cast.toDate(record[29],"yyyy-MM-dd"),
	ServiceEndTime : cast.toLocalTime(record[30],"HH:mm:ss"),
	POSAgencyActualCityCode : cast.toString(record[31]),
	EquipmentCodeDescription : cast.toString(record[32]),
	PreReservedSeatIndicator : cast.toString(record[33]),
	ConfirmationNbr : cast.toString(record[34]),
	FlightPOSAgentIATANbr : cast.toString(record[35]),
	HistoryActionCodeId : cast.toString(record[36]),
	RecordUpdateDate : cast.toDate(record[37],"yyyy-MM-dd"),
	RecordUpdateTime : cast.toLocalTime(record[38],"HH:mm:ss"),
	IntraPNRSetNbr : cast.toNumber(record[39]),
	SegmentBookedDate : cast.toDate(record[40],"yyyy-MM-dd"),
	SegmentBookedTime : cast.toLocalTime(record[41],"HH:mm:ss"),
	OpenFlightSegmentIndicator : cast.toNumber(record[42]),
	SegmentActivityCode : cast.toString(record[43]),
	BSGMSTRPNRLocatorID : cast.toString(record[44]),
	BSGMSTRPNRCreateDate : cast.toDate(record[45],"yyyy-MM-dd"),
	NewMarriedConxGroupNbr : cast.toNumber(record[46]),
	NewMarriedConxSeqNbr : cast.toNumber(record[47]),
	NewMarriedConxOutOfSeqInd : cast.toString(record[48]),
	MarketingClassOfService : cast.toString(record[49]),
	OperatingClassOfService : cast.toString(record[50]),
	IATAEquipCode : cast.toString(record[51]),
	IATAEquipDesc : cast.toString(record[52]),
	OperatingAirlnLocatorID : cast.toString(record[53])
} as Object {class: "com.airmalta.hip.tdbingester.filepojos.ResFlight"}